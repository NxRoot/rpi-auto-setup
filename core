#!/bin/sh

REPLACE_LINE() {
    file_content=$(<$1)
    file_content=${file_content//$2/$3}
    echo "$file_content" > $1
}

REMOVE_LINE() {
    sudo ex -s +"g/$2/d" -cwq $1
}

RESTORE() {
    if [ -f "$1.orig" ]; then
        sudo cp $1.orig $1
    elif [ -f "$1" ]; then
        sudo cp $1 $1.orig
    fi
}

TOGGLE_SERVICE() {
    if [ -f "/etc/systemd/system/$1.service" ]; then
        sudo systemctl stop $1
        sudo systemctl disable $1
        sudo rm -f /etc/systemd/system/$1.service
    else
        CREATE_SERVICE "$1" "$2"
    fi
}

CREATE_SERVICE() {
    sudo echo "[Unit]
    Description=$1
    After=network.target

    [Service]
    ExecStart=/bin/bash -c '$2'
    Restart=always
    RestartSec=5

    [Install]
    WantedBy=multi-user.target" > /etc/systemd/system/$1.service

    sudo systemctl enable $1
    sudo systemctl start $1
}
