#!/usr/bin/env bash
value=$1

config=/etc/samba/smb.conf
folder=shared

sudo rm -rf /home/pi/$folder
mkdir /home/pi/$folder
sudo chmod -R 777 /home/pi/$folder
sudo apt install -y samba samba-common-bin

if [ "$value" != "--smb" ]; then
    folder=$value
fi

RESTORE "$config"
sudo echo "[$folder]" >> $config
sudo echo "path=/home/pi/$folder" >> $config
sudo echo "public = yes" >> $config
sudo echo "read only = no" >> $config
sudo echo "guest only = yes" >> $config
sudo echo "writeable = yes" >> $config
sudo echo "browseable = yes" >> $config
sudo echo "guest ok = yes" >> $config
sudo echo "force create mode = 0666" >> $config
sudo echo "force directory mode = 0777" >> $config